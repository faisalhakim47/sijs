(function(a,b){'object'==typeof exports&&'undefined'!=typeof module?b(exports):'function'==typeof define&&define.amd?define(['exports'],b):b(a.si={})})(this,function(a){'use strict';function b(a,b,{whatToShow:c=5,acceptNode:d=()=>1}={}){const e=document.createTreeWalker(a,c,{acceptNode:d},!1);let f=-1,g=!0;for(const h=()=>g=!1;e.nextNode()&&g;)f++,b(e.currentNode,f,h)}function c(a){const b=s.get(a);if(b)return b;else{const b=new t(a);return s.set(a,b),b}}const d='__sim__',e='__sip__',f='__sii__',g='__siie__';class h{constructor(a){this.nodeIndex=a}}class i extends h{constructor(a,b,c){super(a),this.attributeName=b,this.staticParts=c}}class j extends h{constructor(a){super(a)}}class k extends h{constructor(a,b){super(a),this.eventName=b}}class l extends h{constructor(a){super(a)}}class m{constructor(){this.numberOfPart=1}update(){}}class n extends m{constructor(a,b){super(),this.node=a.parentElement,this.attribute=a,this.staticParts=b,this.oldValue='',this.numberOfPart=b.length-1}update(a){const b=this.staticParts.length;if(1===b&&'boolean'==typeof a[0])a[0]?this.node.removeAttributeNode(this.attribute):this.node.setAttributeNode(this.attribute);else{let c='';for(let d=0;d<b;d++)c+=this.staticParts[d]+(a[d]||'');c!==this.oldValue&&(this.attribute.nodeValue=c,this.oldValue=c)}}}class o extends m{constructor(a){super(),this.node=a,this.prevNode=a.previousSibling,this.nextNode=a.nextSibling,this.options={},a.removeAttribute(d)}update(a){for(const b in a=a[0],a){const c=a[b];if('if'==b){if(c===this.options.if)continue;else c?c&&(this.nextNode.parentNode.insertBefore(this.node,this.nextNode),this.nextNode[g]=!0):(this.nextNode.parentNode.removeChild(this.node),this.nextNode[g]=!1);this.options.if=c}else if('elseIf'==b){const a=this.prevNode[g];if(c===this.options.elseIf&&a===this.options.prevIf)continue;!c||a?(this.nextNode.parentNode.removeChild(this.node),this.nextNode[g]=a):c&&(this.nextNode.parentNode.insertBefore(this.node,this.nextNode),this.nextNode[g]=!0),this.options.prevIf=a,this.options.elseIf=c}}}}class p extends m{constructor(a,b){super(),this.node=a,this.eventName=b,this.oldListener=null,a.removeAttribute('on'+b)}update(a){a=a[0];a===this.oldListener||(this.oldListener&&this.node.removeEventListener(this.eventName,this.oldListener),a&&this.node.addEventListener(this.eventName,a),this.oldListener=a)}}class q{constructor(a,b){this.items=a,this.mapFn=b}update(a,b,c){const d=c.parentNode,e=this.items.length;for(let f=0;f<e;f++){const b=this.mapFn(this.items[f]),e=a.shift();e?b.render(e):d.insertBefore(b.compile().element,c)}for(let e;e=a.shift();)d.removeChild(e)}}class r extends m{constructor(a){super(),null==a.previousSibling&&a.parentNode.insertBefore(document.createTextNode(''),a),null==a.nextSibling&&a.parentNode.appendChild(document.createTextNode('')),this.prevNode=a.previousSibling,this.nextNode=a.nextSibling}get oldElements(){let a=this.prevNode.nextSibling;const b=[];for(;a!==this.nextNode;)b.push(a),a=a.nextSibling;return b}update(a){const b=a[0],c=this.prevNode.nextSibling;b instanceof v?b.render(c):b instanceof q?b.update(this.oldElements,this.prevNode,this.nextNode):b+''!==c.nodeValue&&(c.nodeValue=b)}}const s=new class{constructor(){this.keys=[],this.values=[]}set(a,b){this.keys.push(a),this.values.push(b)}get(a){return this.values[this.keys.indexOf(a)]}remove(a){const b=this.keys.indexOf(a);this.keys.splice(b,1),this.values.splice(b,1)}};class t{constructor(a){const c=[],f=document.createElement('template');f.innerHTML=a.join(d);let g=[];b(f.content,(a)=>{const b=document.createDocumentFragment(),c=a.nodeValue.replace(/__sim__/g,d+e+d).split(d),f=c.length;for(let d=0;d<f;d++)b.appendChild(document.createTextNode(c[d]));g.push(()=>{a.parentNode.replaceChild(b,a)})},{whatToShow:4,acceptNode(a){return-1===a.nodeValue.indexOf(d)?3:1}}),g.forEach((a)=>a()),b(f.content,(a,b)=>{if(3===a.nodeType)return c.push(new l(b));const e=a.attributes.length;for(let f=0;f<e;f++){const e=a.attributes.item(f);e.name===d?c.push(new j(b)):'on'===e.name.slice(0,2)?c.push(new k(b,e.name.slice(2))):-1!==e.nodeValue.indexOf(d)&&c.push(new i(b,e.name,e.nodeValue.split(d)))}},{acceptNode(a){return 3===a.nodeType?a.nodeValue===e?1:3:a.hasAttributes()?1:3}}),this.staticParts=a,this.templateElm=f,this.templateParts=c}create(){const a=[],c=document.importNode(this.templateElm.content,!0);return b(c,(b,c)=>{const d=this.templateParts.length;for(let e=0;e<d;e++){const d=this.templateParts[e];d.nodeIndex===c&&(d instanceof l?a.push(new r(b)):d instanceof i?a.push(new n(b.attributes.getNamedItem(d.attributeName),d.staticParts)):d instanceof j?a.push(new o(b)):d instanceof k&&a.push(new p(b,d.eventName)))}},{acceptNode(a){return 3===a.nodeType?a.nodeValue===e?1:3:a.hasAttributes()?1:3}}),new u(this.staticParts,c.children.item(0),a)}}class u{constructor(a,b,c){this.staticParts=a,this.element=b,this.partUpdaters=c}update(a){for(let b,c=0,d=0;b=this.partUpdaters[d++];)b.update(a.slice(c,c+=b.numberOfPart))}}class v{constructor(a,b){this.staticParts=a,this.dymanicParts=b}verify(a){return this.staticParts===a.staticParts}compile(){const a=c(this.staticParts).create();return a.element[f]=a,a.update(this.dymanicParts),a}render(a){const b=a[f];b instanceof u&&this.verify(b)?b.update(this.dymanicParts):a.parentNode.replaceChild(this.compile().element,a)}}a.html=function(a,...b){return new v(a,b)},a.repeat=function(a,b){return new q(a,b)},Object.defineProperty(a,'__esModule',{value:!0})});